<div class="contenedor">
  <h2 class="page-title">Gestión de Usuarios y Roles</h2>
  <p class="page-description">Administra los accesos y roles de los usuarios registrados.</p>

  <% if (ok) { %>
    <div class="mensaje-exito" style="margin-bottom: 20px;"><%= ok %></div>
  <% } %>
  
  <% if (error) { %>
    <div class="mensaje-error" style="margin-bottom: 20px;"><%= error %></div>
  <% } %>

  <table class="tabla tabla-roles">
    <thead>
      <tr>
        <th>Nombre</th>
        <th>Email</th>
        <th>Rol Actual</th>
        <th>Confirmado</th>
        <th style="text-align: center;">Acciones</th> </tr>
    </thead>
    <tbody>
      <% users.forEach(u => { %>
        <tr>
          <td><%= u.first_name %> <%= u.last_name %></td>
          <td><%= u.email %></td>
          <td>
            <% if (u.role) { %>
              <span class="badge badge-rol"><%= u.role %></span>
            <% } else { %>
              <span class="badge badge-sin-rol">Sin asignar</span>
            <% } %>
          </td>
          <td>
            <%= u.email_confirmed ? '✅ Sí' : '❌ No' %>
          </td>
          
          <td style="text-align: center;">
            <a href="/roles/editar/<%= u.id %>" class="btn-icon" title="Editar Usuario" style="text-decoration: none; font-size: 1.2rem;">
              ✏️
            </a>
          </td>

        </tr>
      <% }) %>
    </tbody>
  </table>
</div>