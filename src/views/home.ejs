<%
  // Los nombres en BD vienen en MAYÚSCULAS: los convertimos a "Title Case"
  function titleCase(s) {
    return String(s || '')
      .toLowerCase()
      .split(' ')
      .filter(Boolean)
      .map(w => w.charAt(0).toUpperCase() + w.slice(1))
      .join(' ');
  }

  // Para mostrar día/mes como en tu imagen (ej: 5/12)
  const mesNum = new Date().getMonth() + 1; // 1-12
%>

<h2>Bienvenida/o a la intranet</h2>

<div class="home-layout">

  <!-- IZQUIERDA: imagen clickeable -->
  <div class="home-left">
    <a href="/sistemas/tickets" class="home-ti-link" title="Ir a Tickets">
      <div class="home-ti-card">
        <img
          src="/img/Img%20Servicios%20TI.png"
          alt="Servicios TI"
          class="home-ti-img"
        />
      </div>
    </a>
  </div>

  <!-- DERECHA: USD + Cumpleañeros del mes -->
  <div class="home-right">

    <div class="tarjeta">
      <h3>USD del día</h3>
      <p class="home-usd"><strong><%= usdHoy %></strong></p>
    </div>

    <div class="tarjeta">
      <h3>Cumpleaños de <%= mesNombre %></h3>

      <% if (!cumpleaniosMes || cumpleaniosMes.length === 0) { %>
        <p>No hay cumpleaños registrados para este mes.</p>
      <% } else { %>

        <div class="cumple-cards">
          <% cumpleaniosMes.forEach((p) => { %>
            <div class="cumple-card <%= (p.dia === diaHoy) ? 'cumple-hoy' : '' %>">
              <div class="cumple-fecha">
                <span class="cumple-dia"><%= p.dia %>/<%= mesNum %></span>
              </div>

              <div class="cumple-info">
                <div class="cumple-nombre"><%= titleCase(p.nombre) %></div>
                <div class="cumple-area">Área: <%= titleCase(p.area) %></div>
              </div>
            </div>
          <% }) %>
        </div>

      <% } %>
    </div>

  </div>
</div>
