<div class="contenedor">
  <h2 class="page-title">Noticias</h2>
  <p class="page-description">Mantente al dÃ­a con las Ãºltimas novedades de Transworld.</p>

  <% if (typeof can !== 'undefined' && can.noticias_write) { %>
    <div style="margin-bottom: 20px;">
      <a class="boton-opcion" href="/noticias/crear">
        + Publicar Nueva Noticia
        <span>Comparte comunicados o novedades con el equipo.</span>
      </a>
    </div>
  <% } %>

  <% if (!noticias || noticias.length === 0) { %>
    <p class="no-data">No hay noticias publicadas aÃºn.</p>
  <% } else { %>
    <div class="grid-noticias" style="display: grid; gap: 20px; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); margin-top: 20px;">
      <% noticias.forEach(n => { %>
        <div class="panel" style="padding: 0; overflow: hidden; display: flex; flex-direction: column; height: 100%;">
          
          <% if (n.imagen) { %>
            <div style="height: 160px; overflow: hidden;">
              <img src="<%= n.imagen %>" style="width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s;">
            </div>
          <% } %>

          <div style="padding: 15px; flex-grow: 1; display: flex; flex-direction: column;">
            <h3 style="margin: 0 0 8px 0; font-size: 1.1rem;">
              <a href="/noticias/<%= n.id %>" style="color: #003a70; text-decoration: none; font-weight: bold;">
                <%= n.titulo %>
              </a>
            </h3>
            
            <% if (n.subtitulo) { %>
              <p style="margin: 0 0 10px 0; color: #666; font-size: 0.9rem;">
                <%= n.subtitulo %>
              </p>
            <% } %>
            
            <div style="margin-top: auto; padding-top: 10px; border-top: 1px solid #eee; font-size: 0.8rem; color: #999; display: flex; justify-content: space-between; align-items: center;">
              <span>ðŸ“… <%= new Date(n.fecha_creacion).toLocaleDateString() %></span>
              <a href="/noticias/<%= n.id %>" style="color: #003a70; text-decoration: underline;">Leer mÃ¡s</a>
            </div>
          </div>

        </div>
      <% }) %>
    </div>
  <% } %>
</div>