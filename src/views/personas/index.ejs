<h2>Personas y Cultura</h2>
<p>Conoce la estructura organizacional, la cultura de la empresa y los cumplea√±os del equipo.</p>

<div class="grid-opciones" style="margin-bottom: 30px; display: flex; gap: 15px; align-items: flex-start;">
  <a class="boton-opcion" href="/personas/organigrama">
    Organigrama
    <span>Visualiza la estructura interna del equipo.</span>
  </a>

  <% if (can.personas_write) { %>
    <a class="boton-opcion" href="/personas/crear" style="border-left: 4px solid #28a745;">
      Agregar Persona
      <span>Registra un nuevo colaborador al equipo.</span>
    </a>
  <% } %>
</div>

<h3>Cumplea√±os del equipo</h3>

<% if (!personas || personas.length === 0) { %>
  <p>No hay cumplea√±os registrados.</p>
<% } else { %>
  <table class="tabla-simple">
    <thead>
      <tr>
        <th>Foto</th>
        <th>Nombre</th>
        <th>√Årea</th>
        <th>Cumplea√±os</th>
        <% if (can.personas_write) { %>
          <th style="width: 120px; text-align: center;">Acciones</th>
        <% } %>
      </tr>
    </thead>
    <tbody>
      <% personas.forEach(p => { %>
        <tr>
          <td>
            <div style="display: flex; justify-content: space-between; align-items: center;">
              <% if (p.foto) { %>
                <img src="<%= p.foto %>" alt="Foto" style="width: 40px; height: 40px; border-radius: 50%; object-fit: cover; border: 2px solid #fff; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
              <span><%= p.nombre %></span>
            
              <% } else { %>
                <div style="width: 40px; height: 40px; border-radius: 50%; background: #eee; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; color: #999;">
                  <%= p.nombre.charAt(0) %>
                </div>
              <% } %>
            </div>
          </td>

          <td><%= p.area %></td>
          <td>
            <%= new Date(p.fecha_nacimiento).toLocaleDateString('es-CL', {
              day: '2-digit',
              month: '2-digit'
            }) %>
          </td>
          
          <% if (can.personas_write) { %>
            <td style="text-align: center;">
              <div style="display: flex; justify-content: center; gap: 8px;">
                <a href="/personas/editar/<%= p.id %>" 
                   class="btn-icon"
                   style="background-color: #007bff; color: white; padding: 6px 10px; border-radius: 4px; text-decoration: none;"
                   title="Editar">
                  ‚úèÔ∏è
                </a>
                
                <form action="/personas/eliminar/<%= p.id %>" method="POST" onsubmit="return confirm('¬øEst√°s seguro de eliminar a <%= p.nombre %>?');" style="margin:0;">
                  <button type="submit" 
                          style="background-color: #dc3545; color: white; border: none; padding: 6px 10px; border-radius: 4px; cursor: pointer;"
                          title="Eliminar">
                    üóëÔ∏è
                  </button>
                </form>
              </div>
            </td>
          <% } %>
        </tr>
      <% }) %>
    </tbody>
  </table>
<% } %>